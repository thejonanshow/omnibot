name: Auto-Migrate Frontend

on:
pull_request:
types: [opened, synchronize]
paths:
- ‚Äò.migrate/**‚Äô
push:
branches:
- main
paths:
- ‚Äô.migrate/**‚Äô

jobs:
migrate:
runs-on: ubuntu-latest
permissions:
contents: write
pull-requests: write

```
steps:
  - name: Checkout code
    uses: actions/checkout@v4
    with:
      fetch-depth: 0
      token: ${{ secrets.GITHUB_TOKEN }}
  
  - name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: '20'
  
  - name: Check if migration needed
    id: check
    run: |
      if [ -f ".migrate/MIGRATE_FRONTEND" ]; then
        echo "migrate=true" >> $GITHUB_OUTPUT
        echo "‚úÖ Migration marker found"
      else
        echo "migrate=false" >> $GITHUB_OUTPUT
        echo "‚è≠Ô∏è  No migration needed"
      fi
  
  - name: Run migration script
    if: steps.check.outputs.migrate == 'true'
    run: |
      chmod +x .migrate/migrate.sh
      .migrate/migrate.sh
  
  - name: Commit migrated files
    if: steps.check.outputs.migrate == 'true'
    run: |
      git config --local user.email "github-actions[bot]@users.noreply.github.com"
      git config --local user.name "github-actions[bot]"
      
      # Add all changes except the marker file
      git add frontend/
      
      if git diff --cached --quiet; then
        echo "No changes to commit"
      else
        git commit -m "chore: Auto-migrate frontend to modular architecture
```

This commit was automatically generated by the migration script.

Changes:

- Split monolithic index.html into modules
- Created data-driven theme system
- Separated CSS into base/themes/components
- Modularized JavaScript
- Added frontend test suite‚Äù
  
  ```
        # Push changes
        if [ "${{ github.event_name }}" == "pull_request" ]; then
          git push origin HEAD:${{ github.head_ref }}
        else
          git push origin HEAD:main
        fi
      fi
  
  - name: Remove migration marker
    if: steps.check.outputs.migrate == 'true' && github.event_name == 'push'
    run: |
      git rm -r .migrate/
      git commit -m "chore: Remove migration marker"
      git push origin HEAD:main
  
  - name: Comment on PR
    if: steps.check.outputs.migrate == 'true' && github.event_name == 'pull_request'
    uses: actions/github-script@v7
    with:
      script: |
        github.rest.issues.createComment({
          issue_number: context.issue.number,
          owner: context.repo.owner,
          repo: context.repo.repo,
          body: 'ü§ñ **Migration Complete!**\n\n‚úÖ Frontend has been automatically refactored to modular architecture.\n\n**Review the changes and merge when ready!**\n\nThe migration marker will be automatically removed when merged to main.'
        })
  ```